<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:local="clr-namespace:CbetaTranslator.App.Views"
             xmlns:ae="clr-namespace:AvaloniaEdit;assembly=AvaloniaEdit"
             x:Class="CbetaTranslator.App.Views.ReadableTabView">


	<!-- LOCAL FALLBACK RESOURCES (same idea as TranslationTabView) -->
	<UserControl.Resources>
		<SolidColorBrush x:Key="PanelBg" Color="#FF151515"/>
		<SolidColorBrush x:Key="PanelAltBg" Color="#FF1E1E1E"/>
		<SolidColorBrush x:Key="PanelBorder" Color="#FF2E2E2E"/>
		<SolidColorBrush x:Key="SplitterBrush" Color="#FF2A2A2A"/>
		<SolidColorBrush x:Key="MutedFg" Color="#FF9A9A9A"/>
	</UserControl.Resources>

	<UserControl.Styles>
		<!-- If you still use AvaloniaEdit elsewhere, keep its theme include.
         AnnotatedTextEditor DOES contain a TextEditor, so this is fine. -->
		<StyleInclude Source="avares://AvaloniaEdit/Themes/Fluent/AvaloniaEdit.xaml" />

		<Style Selector="TextBlock.muted">
			<Setter Property="Foreground" Value="{DynamicResource MutedFg}"/>
		</Style>

		<!-- Style the INNER AvaloniaEdit TextEditor, not the wrapper UserControl -->
		<Style Selector="local|AnnotatedTextEditor ae|TextEditor">
			<Setter Property="Background" Value="Transparent"/>
			<Setter Property="Foreground" Value="#FFE6E6E6"/>
			<Setter Property="FontFamily" Value="Consolas"/>
			<Setter Property="WordWrap" Value="True"/>
			<Setter Property="HorizontalScrollBarVisibility" Value="Disabled"/>
			<Setter Property="VerticalScrollBarVisibility" Value="Auto"/>
		</Style>
	</UserControl.Styles>

	<Grid RowDefinitions="Auto,Auto,*,Auto">

		<StackPanel Grid.Row="0"
					Orientation="Horizontal"
					Spacing="8"
					Margin="0,0,0,8">
			<Button Name="BtnAddCommunityNote"
					Content="Add community note"
					Focusable="False"/>
		</StackPanel>

		<Border Name="FindBar"
				Grid.Row="1"
				Background="{DynamicResource PanelAltBg}"
				Padding="8"
				CornerRadius="8"
				Margin="0,0,0,8"
				IsVisible="False">
			<DockPanel LastChildFill="True">
				<TextBlock Name="FindScope"
						   DockPanel.Dock="Left"
						   Classes="muted"
						   VerticalAlignment="Center"
						   Margin="0,0,10,0"
						   Text="Find:" />

				<TextBox Name="FindQuery"
						 Watermark="Find…"
						 MinWidth="260"
						 VerticalAlignment="Center"/>

				<StackPanel DockPanel.Dock="Right"
							Orientation="Horizontal"
							Spacing="8"
							Margin="10,0,0,0">
					<TextBlock Name="FindCount"
							   Classes="muted"
							   VerticalAlignment="Center"
							   Text="0/0" />
					<Button Name="BtnPrev" Content="Prev" Focusable="False"/>
					<Button Name="BtnNext" Content="Next" Focusable="False"/>
					<Button Name="BtnCloseFind" Content="✕" Focusable="False"/>
				</StackPanel>
			</DockPanel>
		</Border>

		<Grid Grid.Row="2" ColumnDefinitions="1*,Auto,2*" Margin="0">

			<Border Background="{DynamicResource PanelBg}"
					BorderBrush="{DynamicResource PanelBorder}"
					BorderThickness="1"
					CornerRadius="6">
				<Grid RowDefinitions="Auto,*">
					<Border Background="{DynamicResource PanelBg}" Padding="8">
						<TextBlock Text="Original (read-only)" Classes="muted"/>
					</Border>

					<local:AnnotatedTextEditor Name="EditorOriginal"
											   Grid.Row="1"/>
				</Grid>
			</Border>

			<GridSplitter Grid.Column="1" Width="6" Background="{DynamicResource SplitterBrush}"/>

			<Border Grid.Column="2"
					Background="{DynamicResource PanelBg}"
					BorderBrush="{DynamicResource PanelBorder}"
					BorderThickness="1"
					CornerRadius="6">
				<Grid RowDefinitions="Auto,*">
					<Border Background="{DynamicResource PanelBg}" Padding="8">
						<TextBlock Text="Translated (readable view)" Classes="muted"/>
					</Border>

					<local:AnnotatedTextEditor Name="EditorTranslated"
											   Grid.Row="1"/>
				</Grid>
			</Border>

		</Grid>

		<Border Grid.Row="3"
				Name="NotesPanel"
				IsVisible="False"
				Background="{DynamicResource PanelAltBg}"
				BorderBrush="{DynamicResource PanelBorder}"
				BorderThickness="1"
				CornerRadius="8"
				Margin="0,8,0,0"
				Padding="10">

			<Grid RowDefinitions="Auto,*" ColumnDefinitions="*,Auto">
				<TextBlock Name="NotesHeader"
						   Grid.Row="0" Grid.Column="0"
						   FontWeight="SemiBold"
						   Text="Note" />

				<StackPanel Grid.Row="0" Grid.Column="1" Orientation="Horizontal" Spacing="6">
					<Button Name="BtnDeleteCommunityNote"
							Content="Delete"
							Padding="10,2"
							Focusable="False"/>
					<Button Name="BtnCloseNotes"
							Content="✕"
							Padding="8,2"
							Focusable="False"/>
				</StackPanel>

				<ScrollViewer Grid.Row="1"
							  Grid.ColumnSpan="2"
							  MaxHeight="160"
							  VerticalScrollBarVisibility="Auto"
							  HorizontalScrollBarVisibility="Disabled">
					<TextBox Name="NotesBody"
							 IsReadOnly="True"
							 AcceptsReturn="True"
							 TextWrapping="Wrap"
							 Background="Transparent"
							 BorderThickness="0"/>
				</ScrollViewer>
			</Grid>

		</Border>

	</Grid>
</UserControl>
