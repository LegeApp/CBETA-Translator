<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:views="clr-namespace:CbetaTranslator.App.Views"
        xmlns:models="clr-namespace:CbetaTranslator.App.Models"
        x:Class="CbetaTranslator.App.Views.MainWindow"
        Width="1400" Height="900"
        Background="{DynamicResource AppBg}"
        Title="CBETA Translator">

	<!-- THEME SOURCE VALUES (REAL brushes) -->
	<Window.Resources>

		<!-- NIGHT -->
		<SolidColorBrush x:Key="Night_AppBg" Color="#FF111111"/>
		<SolidColorBrush x:Key="Night_BarBg" Color="#FF1E1E1E"/>
		<SolidColorBrush x:Key="Night_NavBg" Color="#FF1A1A1A"/>

		<SolidColorBrush x:Key="Night_TextFg" Color="#FFEAEAEA"/>
		<SolidColorBrush x:Key="Night_TextMutedFg" Color="#FFBDBDBD"/>

		<SolidColorBrush x:Key="Night_ControlBg" Color="#FF2B2B2B"/>
		<SolidColorBrush x:Key="Night_ControlBgHover" Color="#FF303030"/>
		<SolidColorBrush x:Key="Night_ControlBgFocus" Color="#FF343434"/>

		<SolidColorBrush x:Key="Night_BorderBrush" Color="#FF444444"/>

		<SolidColorBrush x:Key="Night_BtnBg" Color="#FF2A2A2A"/>
		<SolidColorBrush x:Key="Night_BtnBgHover" Color="#FF333333"/>
		<SolidColorBrush x:Key="Night_BtnBgPressed" Color="#FF3A3A3A"/>
		<SolidColorBrush x:Key="Night_BtnFg" Color="#FFEAEAEA"/>

		<SolidColorBrush x:Key="Night_TabBg" Color="#FF1E1E1E"/>
		<SolidColorBrush x:Key="Night_TabBgSelected" Color="#FF2B2B2B"/>
		<SolidColorBrush x:Key="Night_TabFgSelected" Color="#FFEAEAEA"/>

		<SolidColorBrush x:Key="Night_TooltipBg" Color="#FF0F0F0F"/>
		<SolidColorBrush x:Key="Night_TooltipBorder" Color="#FF3A3A3A"/>
		<SolidColorBrush x:Key="Night_TooltipFg" Color="#FFEAEAEA"/>

		<!-- LIGHT -->
		<SolidColorBrush x:Key="Light_AppBg" Color="#FFF4F4F4"/>
		<SolidColorBrush x:Key="Light_BarBg" Color="#FFEDEDED"/>
		<SolidColorBrush x:Key="Light_NavBg" Color="#FFE9E9E9"/>

		<SolidColorBrush x:Key="Light_TextFg" Color="#FF1A1A1A"/>
		<SolidColorBrush x:Key="Light_TextMutedFg" Color="#FF5A5A5A"/>

		<SolidColorBrush x:Key="Light_ControlBg" Color="#FFFFFFFF"/>
		<!-- hover/focus must NOT jump dark -->
		<SolidColorBrush x:Key="Light_ControlBgHover" Color="#FFF6F6F6"/>
		<SolidColorBrush x:Key="Light_ControlBgFocus" Color="#FFF1F1F1"/>

		<SolidColorBrush x:Key="Light_BorderBrush" Color="#FFB8B8B8"/>

		<SolidColorBrush x:Key="Light_BtnBg" Color="#FFE7E7E7"/>
		<SolidColorBrush x:Key="Light_BtnBgHover" Color="#FFDCDCDC"/>
		<SolidColorBrush x:Key="Light_BtnBgPressed" Color="#FFD2D2D2"/>
		<SolidColorBrush x:Key="Light_BtnFg" Color="#FF1A1A1A"/>

		<SolidColorBrush x:Key="Light_TabBg" Color="#FFEDEDED"/>
		<SolidColorBrush x:Key="Light_TabBgSelected" Color="#FFFFFFFF"/>
		<SolidColorBrush x:Key="Light_TabFgSelected" Color="#FF1A1A1A"/>

		<SolidColorBrush x:Key="Light_TooltipBg" Color="#FF111111"/>
		<SolidColorBrush x:Key="Light_TooltipBorder" Color="#FF333333"/>
		<SolidColorBrush x:Key="Light_TooltipFg" Color="#FFF2F2F2"/>

		<!-- TOKENS (REAL VALUES). Default = Night. Code-behind overwrites on toggle. -->
		<SolidColorBrush x:Key="AppBg" Color="#FF111111"/>
		<SolidColorBrush x:Key="BarBg" Color="#FF1E1E1E"/>
		<SolidColorBrush x:Key="NavBg" Color="#FF1A1A1A"/>

		<SolidColorBrush x:Key="TextFg" Color="#FFEAEAEA"/>
		<SolidColorBrush x:Key="TextMutedFg" Color="#FFBDBDBD"/>

		<SolidColorBrush x:Key="ControlBg" Color="#FF2B2B2B"/>
		<SolidColorBrush x:Key="ControlBgHover" Color="#FF303030"/>
		<SolidColorBrush x:Key="ControlBgFocus" Color="#FF343434"/>

		<SolidColorBrush x:Key="BorderBrush" Color="#FF444444"/>

		<SolidColorBrush x:Key="BtnBg" Color="#FF2A2A2A"/>
		<SolidColorBrush x:Key="BtnBgHover" Color="#FF333333"/>
		<SolidColorBrush x:Key="BtnBgPressed" Color="#FF3A3A3A"/>
		<SolidColorBrush x:Key="BtnFg" Color="#FFEAEAEA"/>

		<SolidColorBrush x:Key="TabBg" Color="#FF1E1E1E"/>
		<SolidColorBrush x:Key="TabBgSelected" Color="#FF2B2B2B"/>
		<SolidColorBrush x:Key="TabFgSelected" Color="#FFEAEAEA"/>

		<SolidColorBrush x:Key="TooltipBg" Color="#FF0F0F0F"/>
		<SolidColorBrush x:Key="TooltipBorder" Color="#FF3A3A3A"/>
		<SolidColorBrush x:Key="TooltipFg" Color="#FFEAEAEA"/>

	</Window.Resources>

	<!-- GLOBAL STYLES -->
	<Window.Styles>

		<!-- Default text -->
		<Style Selector="TextBlock">
			<Setter Property="Foreground" Value="{DynamicResource TextFg}"/>
		</Style>

		<Style Selector="TextBlock.muted">
			<Setter Property="Foreground" Value="{DynamicResource TextMutedFg}"/>
		</Style>

		<!-- ToolTip fix: black bg + readable text -->
		<Style Selector="ToolTip">
			<Setter Property="Background" Value="{DynamicResource TooltipBg}"/>
			<Setter Property="BorderBrush" Value="{DynamicResource TooltipBorder}"/>
			<Setter Property="BorderThickness" Value="1"/>
			<Setter Property="Foreground" Value="{DynamicResource TooltipFg}"/>
			<Setter Property="Padding" Value="8,6"/>
		</Style>
		<Style Selector="ToolTip TextBlock">
			<Setter Property="Foreground" Value="{DynamicResource TooltipFg}"/>
		</Style>

		<!-- Buttons: lock foreground across states (prevents white-on-white) -->
		<Style Selector="Button">
			<Setter Property="Background" Value="{DynamicResource BtnBg}"/>
			<Setter Property="Foreground" Value="{DynamicResource BtnFg}"/>
			<Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}"/>
			<Setter Property="BorderThickness" Value="1"/>
			<Setter Property="Padding" Value="10,4"/>
		</Style>
		<Style Selector="Button:pointerover">
			<Setter Property="Background" Value="{DynamicResource BtnBgHover}"/>
			<Setter Property="Foreground" Value="{DynamicResource BtnFg}"/>
		</Style>
		<Style Selector="Button:pressed">
			<Setter Property="Background" Value="{DynamicResource BtnBgPressed}"/>
			<Setter Property="Foreground" Value="{DynamicResource BtnFg}"/>
		</Style>
		<Style Selector="Button:disabled">
			<Setter Property="Foreground" Value="{DynamicResource TextMutedFg}"/>
		</Style>

		<!-- TextBoxes: no dark jump on hover/focus -->
		<Style Selector="TextBox">
			<Setter Property="Background" Value="{DynamicResource ControlBg}"/>
			<Setter Property="Foreground" Value="{DynamicResource TextFg}"/>
			<Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}"/>
			<Setter Property="BorderThickness" Value="1"/>
			<Setter Property="CaretBrush" Value="{DynamicResource TextFg}"/>
		</Style>
		<Style Selector="TextBox:pointerover">
			<Setter Property="Background" Value="{DynamicResource ControlBgHover}"/>
		</Style>
		<Style Selector="TextBox:focus">
			<Setter Property="Background" Value="{DynamicResource ControlBgFocus}"/>
			<Setter Property="Foreground" Value="{DynamicResource TextFg}"/>
			<Setter Property="CaretBrush" Value="{DynamicResource TextFg}"/>
		</Style>

		<!-- CheckBox -->
		<Style Selector="CheckBox">
			<Setter Property="Foreground" Value="{DynamicResource TextFg}"/>
		</Style>

		<!-- ComboBox -->
		<Style Selector="ComboBox">
			<Setter Property="Background" Value="{DynamicResource ControlBg}"/>
			<Setter Property="Foreground" Value="{DynamicResource TextFg}"/>
			<Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}"/>
			<Setter Property="BorderThickness" Value="1"/>
		</Style>

		<!-- Tabs: stop selected header turning white (override header presenter too) -->
		<Style Selector="TabControl">
			<Setter Property="Background" Value="{DynamicResource TabBg}"/>
		</Style>

		<Style Selector="TabItem">
			<Setter Property="Background" Value="{DynamicResource TabBg}"/>
			<Setter Property="Foreground" Value="{DynamicResource TextFg}"/>
		</Style>

		<Style Selector="TabItem:selected">
			<Setter Property="Background" Value="{DynamicResource TabBgSelected}"/>
			<Setter Property="Foreground" Value="{DynamicResource TabFgSelected}"/>
		</Style>

		<!-- This is the key bit that usually fixes "selected tab text still white": -->
		<Style Selector="TabItem:selected ContentPresenter">
			<Setter Property="TextBlock.Foreground" Value="{DynamicResource TabFgSelected}"/>
		</Style>
		<Style Selector="TabItem ContentPresenter">
			<Setter Property="TextBlock.Foreground" Value="{DynamicResource TextFg}"/>
		</Style>

		<Style Selector="ListBox">
			<Setter Property="Foreground" Value="{DynamicResource TextFg}"/>
		</Style>
		<Style Selector="TreeView">
			<Setter Property="Foreground" Value="{DynamicResource TextFg}"/>
		</Style>

	</Window.Styles>

	<Grid RowDefinitions="Auto,*,Auto">

		<!-- Top bar -->
		<Border Grid.Row="0" Background="{DynamicResource BarBg}" Padding="10">
			<DockPanel LastChildFill="True">

				<StackPanel Orientation="Horizontal" Spacing="8" DockPanel.Dock="Left">
					<Button Name="BtnToggleNav" Width="40" Height="32" Content="☰"/>
					<Button Name="BtnOpenRoot" Width="140" Height="32" Content="Open Root"/>

					<Button Name="BtnLicenses" Width="110" Height="32" Content="ⓘ Licenses"/>

					<CheckBox Name="ChkNightMode"
							  Content="Night mode"
							  VerticalAlignment="Center"
							  Margin="10,0,0,0"
							  IsChecked="True"/>

					<TextBlock Name="TxtRoot"
							   VerticalAlignment="Center"
							   Margin="10,0,0,0"
							   Classes="muted"/>
				</StackPanel>

				<TextBlock Name="TxtCurrentFile"
						   DockPanel.Dock="Right"
						   VerticalAlignment="Center"
						   HorizontalAlignment="Right"
						   Classes="muted"/>
			</DockPanel>
		</Border>

		<!-- Main content -->
		<Grid Grid.Row="1" ColumnDefinitions="Auto,Auto,*">

			<Border Name="NavPanel" Background="{DynamicResource NavBg}" Width="320">
				<Grid Margin="8" RowDefinitions="Auto,Auto,Auto,*" RowSpacing="8">

					<TextBlock Text="Files" FontWeight="Bold" Margin="4" Classes="muted"/>

					<TextBox Name="NavSearch"
							 Grid.Row="1"
							 Watermark="Search (filename or title)…"/>

					<CheckBox Name="ChkShowFilenames"
							  Grid.Row="2"
							  Content="Show filenames"
							  IsChecked="False"/>

					<ListBox Name="FilesList"
							 Grid.Row="3"
							 Background="{DynamicResource ControlBg}"
							 BorderBrush="{DynamicResource BorderBrush}"
							 BorderThickness="1">

						<ListBox.ItemTemplate>
							<DataTemplate x:DataType="models:FileNavItem">
								<Border CornerRadius="6"
										Padding="6"
										Margin="4"
										Background="{Binding Status, Converter={x:Static views:NavStatusToBrushConverter.Instance}}">
									<TextBlock Text="{Binding DisplayShort}"
											   ToolTip.Tip="{Binding Tooltip}"
											   TextWrapping="NoWrap"/>
								</Border>
							</DataTemplate>
						</ListBox.ItemTemplate>

					</ListBox>

				</Grid>
			</Border>

			<!-- Right side: Tabs -->
			<Border Grid.Column="2" Margin="8" Background="#00000000">
				<TabControl Name="MainTabs">
					<TabItem Header="Readable">
						<views:ReadableTabView Name="ReadableView"/>
					</TabItem>
					<TabItem Header="Translate XML">
						<views:TranslationTabView Name="TranslationView"/>
					</TabItem>
					<TabItem Header="Search">
						<views:SearchTabView Name="SearchView"/>
					</TabItem>
					<TabItem Header="Git">
						<views:GitTabView Name="GitView"/>
					</TabItem>
				</TabControl>
			</Border>

		</Grid>

		<!-- Status bar -->
		<Border Grid.Row="2" Background="{DynamicResource BarBg}" Padding="8">
			<TextBlock Name="TxtStatus" Classes="muted"/>
		</Border>

	</Grid>
</Window>
